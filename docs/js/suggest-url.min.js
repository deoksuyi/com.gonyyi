// Copyright (c) 2021 Gon Y. Yi <https://gonyyi.com/copyright>
var maxRes,result,keyword,sugg,keys;function bigrams(e){for(var t=e.toLowerCase(),s=t.split(""),r=0;r<s.length;r++)s[r]=t.slice(r,r+2);return s}function similarity(e="",t=""){if(e.length>0&&t.length>0){for(var s=bigrams(e),r=bigrams(t),l=s.length+r.length,n=0,a=0;a<s.length;a++)for(var i=0;i<r.length;i++)s[a]==r[i]&&n++;if(n>0)return 2*n/l}return 0}function search(){resultReset(),tmpRes=[],keys.forEach(function(e){for(highestScore=0,i=0;i<e.keywords.length;i++)score=similarity(e.keywords[i],keyword),score>highestScore&&(highestScore=score);highestScore>.2&&tmpRes.push({data:e,score:highestScore})}),tmpRes.length>0?(tmpResIdx=Object.keys(tmpRes).sort(function(e,t){return tmpRes[e].score>tmpRes[t].score?1:tmpRes[e].score<tmpRes[t].score?-1:tmpRes[e].data.keywords>tmpRes[t].data.keywords?-1:tmpRes[e].data.keywords<tmpRes[t].data.keywords?1:0}).reverse(),-1!=maxRes&&tmpResIdx.length>maxRes&&(tmpResIdx=tmpResIdx.slice(0,maxRes)),tmpResIdx.length>0&&(hr=document.createElement("hr"),h2=document.createElement("h2"),h2.innerHTML="suggestions",small=document.createElement("small"),small.innerHTML="blah blah",ul=document.createElement("ul"),result=document.createElement("li"),ul.appendChild(result),sugg.appendChild(hr),sugg.appendChild(h2),sugg.appendChild(small),sugg.appendChild(ul),tmpResIdx.forEach(function(e){resultAdd(tmpRes[e])}))):resultEmpty()}function resultEmpty(){if(null!=result)try{result.innerHTML="<li>not available</li>"}catch(e){console.log(e)}}function resultReset(){if(null!=result)try{result.innerHTML=""}catch(e){console.log(e)}}function resultAdd(e){tmp_li=document.createElement("li"),tmp_a=document.createElement("a"),tmp_a.setAttribute("href",e.data.url),tmp_a.innerHTML=e.data.url+" ",tmp_i=document.createElement("i"),tmp_i.innerHTML=e.score.toFixed(2)+" pts",tmp_a.appendChild(tmp_i),tmp_li.appendChild(tmp_a),result.appendChild(tmp_li)}function run(e,t){keyword=window.location.pathname.replaceAll("/"," ").trim(),sugg=document.getElementById(e),maxRes=t,search()}console.log("DSYiM Search Keyword - (c) 2021 gon/y/yi");
